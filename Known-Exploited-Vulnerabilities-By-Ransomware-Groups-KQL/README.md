# Known Exploited Vulnerabilities by Ransomware Groups  

| **Attack Vector:** Network 
| **Privileges Required:** None  

---

## üìú Description  

This repository provides a curated dataset of **Known Exploited Vulnerabilities (KEVs)** actively exploited by ransomware groups. These vulnerabilities are particularly dangerous as they can be exploited directly over a network without requiring prior access or elevated privileges. 

---

## üõ†Ô∏è Key Attributes  

- ‚úÖ **CISA Known Exploited Vulnerability**  
- üè¥‚Äç‚ò†Ô∏è **Actively exploited by ransomware groups**  
- **Attack Vector:** Network  
- **Privileges Required:** None  

---

## üë• Attribution & Threat Actors  
The vulnerabilities in this dataset are linked to **ransomware groups** leveraging them for initial access and system compromise.

---

## üõ°Ô∏è ATT&CK Techniques  

**MITRE ATT&CK techniques associated with the Known Exploited Vulnerabilities Dataset**:  

- **T1190 - Exploit Public-Facing Application**  
- **T1068 - Exploitation for Privilege Escalation**  
- **T1505.003 - Server Software Component: Web Shell**  
- **T1589.001 - Gather Victim Identity Information: Credentials**  
- **T1552.004 - Unsecured Credentials in Configuration Files**
- **T1005 - Data from Local System**  
- **T1059 - Command and Scripting Interpreter(includes Bash, PowerShell, etc.)**
- **T1203 - Exploitation for Client Execution**
- **T1105 - Ingress Tool Transfer (delivering payloads)**
- **1552.001 - Credentials in Files**
- **T1136 - Create Account**  
- **T1070.004 - File Deletion**  
- **T1105 - Ingress Tool Transfer**  
- **T1133 - External Remote Services**  
- **T1539 - Steal Web Session Cookie**  
- **T1565.001 - Data Manipulation: Stored Data Manipulation**  

---

## üîç Detection Opportunities (KQL Advanced Threat Hunting Queries)  to Identify and Monitor Vulnerable Assets

### 1Ô∏è‚É£ **Detection Opportunity 1: All Vulnerable Devices**  

```kql
// Replace "Timestamp" with "TimeGenerated" when running this KQL query in Microsoft Sentinel.
let timeframe = 24hr;
let CVEs_Known_Exploited_By_Ransomware_Groups = externaldata(dateAdded: string, CVEid: string, Vendor: string, Product: string, Attack_Vector: string, Privileges_Required: string, Consequences: string, CISA_Known_Exploited_Vulnerability: string, Known_Exploited_By_Ransomware_Groups: string, requiredAction: string, notes: string, cwes: string, URL: string)[@"https://raw.githubusercontent.com/CTI-Driven/Advanced-Threat-Hunting-Ransomware-Groups-Affiliates/refs/heads/main/Known-Exploited-Vulnerabilities-By-Ransomware-Groups-KQL/KnownExploitedVulnerabilitiesByRansomwareGroupsDataset.csv"] with (format="csv", ignoreFirstRecord=True);
DeviceInfo
| where Timestamp >= ago(timeframe)
| extend InternetFacing= iff(IsInternetFacing, "Is InternetFacing", "Not InternetFacing")
| join kind=inner DeviceTvmSoftwareVulnerabilities on DeviceId
| summarize arg_max(Timestamp, *) by DeviceId
| join kind=inner CVEs_Known_Exploited_By_Ransomware_Groups on $left.CveId==$right.CVEid
| project Timestamp,DeviceName,DeviceType,OnboardingStatus,OSDistribution,InternetFacing,PublicIP,LoggedOnUsers,CVEid,dateAdded,Vendor1,Product,Attack_Vector,Privileges_Required,Consequences,VulnerabilitySeverityLevel,CISA_Known_Exploited_Vulnerability,Known_Exploited_By_Ransomware_Groups, RecommendedSecurityUpdate,AdditionalFields,requiredAction,notes,cwes,URL,ReportId
```

---

### 2Ô∏è‚É£ **Detection Opportunity 2: Devices with Critical Identities**  

```kql
// Replace "Timestamp" with "TimeGenerated" when running this KQL query in Microsoft Sentinel.
let timeframe = 24hr;
let CVEs_Known_Exploited_By_Ransomware_Groups = externaldata(dateAdded: string, CVEid: string, Vendor: string, Product: string, Attack_Vector: string, Privileges_Required: string, Consequences: string, CISA_Known_Exploited_Vulnerability: string, Known_Exploited_By_Ransomware_Groups: string, requiredAction: string, notes: string, cwes: string, URL: string)[@"https://raw.githubusercontent.com/CTI-Driven/Advanced-Threat-Hunting-Ransomware-Groups-Affiliates/refs/heads/main/Known-Exploited-Vulnerabilities-By-Ransomware-Groups-KQL/KnownExploitedVulnerabilitiesByRansomwareGroupsDataset.csv"] with (format="csv", ignoreFirstRecord=True);
let DevicesWithCriticalIdentities = ( ExposureGraphNodes
| where set_has_element(Categories, "identity")
| extend identity="Critical Identities"
| where isnotnull(NodeProperties.rawData.criticalityLevel) and NodeProperties.rawData.criticalityLevel.criticalityLevel < 4 //Critical Identities
| join kind=inner (ExposureGraphEdges | where EdgeLabel == @"has credentials of") on $left.NodeId==$right.TargetNodeId
| summarize arg_max(NodeId, *) by SourceNodeName
| project identity,NodeName,EdgeLabel,SourceNodeName);
let Devices_With_Known_Exploited_CVEs=( DeviceInfo
| where Timestamp >= ago(timeframe)
| extend InternetFacing= iff(IsInternetFacing, "Is InternetFacing", "Not InternetFacing")
| join kind=inner DeviceTvmSoftwareVulnerabilities on DeviceId
| summarize arg_max(Timestamp, *) by DeviceId
| join kind=inner CVEs_Known_Exploited_By_Ransomware_Groups on $left.CveId==$right.CVEid
| project Timestamp,DeviceName,DeviceType,OnboardingStatus,OSDistribution,InternetFacing,PublicIP,LoggedOnUsers,CVEid,dateAdded,Vendor1,Product,Attack_Vector,Privileges_Required,Consequences,VulnerabilitySeverityLevel,CISA_Known_Exploited_Vulnerability,Known_Exploited_By_Ransomware_Groups, RecommendedSecurityUpdate,AdditionalFields,requiredAction,notes,cwes,URL,ReportId);
Devices_With_Known_Exploited_CVEs
| join kind=inner DevicesWithCriticalIdentities on $left.DeviceName==$right.SourceNodeName
| project Timestamp,identity,NodeName,EdgeLabel,DeviceName,DeviceType,OnboardingStatus,OSDistribution,InternetFacing,PublicIP,LoggedOnUsers,CVEid,dateAdded,Vendor1,Product,Attack_Vector,Privileges_Required,Consequences,VulnerabilitySeverityLevel,CISA_Known_Exploited_Vulnerability,Known_Exploited_By_Ransomware_Groups, RecommendedSecurityUpdate,AdditionalFields,requiredAction,notes,cwes,URL,ReportId
```

---

### 3Ô∏è‚É£ **Visualization: Top 10 Vulnerabilities by CVEID & Vendor**  

```kql
// Replace "Timestamp" with "TimeGenerated" when running this KQL query in Microsoft Sentinel.
let timeframe = 24hr;
let CVEs_Known_Exploited_By_Ransomware_Groups = externaldata(dateAdded: string, CVEid: string, Vendor: string, Product: string, Attack_Vector: string, Privileges_Required: string, Consequences: string, CISA_Known_Exploited_Vulnerability: string, Known_Exploited_By_Ransomware_Groups: string, requiredAction: string, notes: string, cwes: string, URL: string)[@"https://raw.githubusercontent.com/CTI-Driven/Advanced-Threat-Hunting-Ransomware-Groups-Affiliates/refs/heads/main/Known-Exploited-Vulnerabilities-By-Ransomware-Groups-KQL/KnownExploitedVulnerabilitiesByRansomwareGroupsDataset.csv"] with (format="csv", ignoreFirstRecord=True);
DeviceInfo
| where Timestamp >= ago(timeframe)
| extend InternetFacing= iff(IsInternetFacing, "Is InternetFacing", "Not InternetFacing")
| join kind=inner DeviceTvmSoftwareVulnerabilities on DeviceId
| summarize arg_max(Timestamp, *) by DeviceId
| join kind=inner CVEs_Known_Exploited_By_Ransomware_Groups on $left.CveId==$right.CVEid
| summarize Count= dcount(DeviceId) by CveId, Vendor1
| top 10 by Count
| render columnchart
```

---

## üõë Mitigation Strategies  

To reduce risk and remediate vulnerabilities:  
- **Follow advisories provided by the product vendor** to apply necessary patches or mitigations.  
- Implement best practices for securing public-facing applications:  
  - Regular software updates (**M1051 - Update Software**).  
  - Network segmentation to limit exposure (**M1030 - Network Segmentation**).  
  - Multi-factor authentication (**M1032 - Multi-factor Authentication**).  

---

## üìö References  

- [**CISA Known Exploited Vulnerabilities Catalog**](https://www.cisa.gov/known-exploited-vulnerabilities-catalog)  
- [**The Shadowserver Foundation**](https://dashboard.shadowserver.org)  
- [**NIST National Vulnerability Database**](https://nvd.nist.gov/vuln)  
- [**IBM X-Force Exchange**](https://exchange.xforce.ibmcloud.com)  

---
